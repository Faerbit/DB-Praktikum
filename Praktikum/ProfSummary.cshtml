@using System.Data.SqlClient;
@using System.Configuration;

@{
    Layout = "~/Layout.cshtml";
    <div class="row">
        <div class="col-md-12">
            @{
                string connStr = ConfigurationManager.ConnectionStrings["dbConnString"].ConnectionString;
                var connection = new SqlConnection(connStr);
                var query = @" 
                    select Professoren.AkademischerTitel, Benutzer.Nachname from Professoren 
                    join Benutzer on Professoren.Nickname = Benutzer.Nickname
                    where Professoren.Nickname = '" + @Request.QueryString["prof"] + "'";
                var sqlcmd = new SqlCommand(query, connection);
                connection.Open();
                SqlDataReader reader = sqlcmd.ExecuteReader();
                reader.Read();
                string text = Praktikum.PrakHelpers.profTitelHelper(reader["AkademischerTitel"].ToString()) + " " + reader["Nachname"].ToString();
                connection.Close();
            }
            <h1>@Html.Raw(@text)</h1>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
    <h1>Forum Beiträge</h1>
    
        @{string _connStr = ConfigurationManager.ConnectionStrings["dbConnString"].ConnectionString;
                var _connection = new SqlConnection(_connStr);
                var _query = "select Bezeichnung from Beiträge join Diskussionen on Beiträge.DiskussionsID = Diskussionen.ID join Foren on Diskussionen.ForumID = Foren.ID where Benutzer = '" + @Request.QueryString["prof"] + "'";
                var _sqlcmd = new SqlCommand(_query, _connection);
            }@{ 
            _connection.Open();
                SqlDataReader _reader = _sqlcmd.ExecuteReader();
            List<string> foren = new List<string>();
                while (_reader.Read())
                {
                    foren.Add(_reader["Bezeichnung"].ToString());
                }
                _connection.Close();
            }

            @foreach (string forum in foren)
            {
                <h3>@forum</h3>
            }

        </div>
        <div class="col-md-6">
            <div class="row">
                <h1>Bereitgestellte Dokumente</h1>
                @RenderPage("~/DokumentSummary.cshtml")
            </div>
            <div class="row">
                <h1>Verantworlich für folgende Module</h1>
                @RenderPage("~/ModuleSummary.cshtml")
            </div>
        </div>
    </div>
    <div class="row">
        <div class="pull-right">
            <h3>
                <a href="~/Module.cshtml">Aktuelle Module</a>
            </h3>
        </div>
    </div>
}